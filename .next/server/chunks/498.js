"use strict";exports.id=498,exports.ids=[498],exports.modules={24493:(e,t,s)=>{s.d(t,{P:()=>i});var r=s(17577),a=s(51471);class c{transformSubscription(e){let t=e.customer?.name||e.customer_name||"Unknown Customer";return{id:e.id,customerName:t,customerId:e.customer_id,customer:e.customer?{id:e.customer.id,name:e.customer.name,email:e.customer.email,phone:e.customer.phone||void 0,company:e.customer.company||void 0,address:e.customer.address||void 0,createdAt:new Date(e.customer.created_at),updatedAt:new Date(e.customer.updated_at)}:void 0,licenseKey:e.license_key,tier:e.tier,status:e.status,features:e.features?.enabled_features||[],maxDevices:e.max_devices,devicesConnected:e.devices?.length||0,startsAt:new Date(e.starts_at),expiresAt:new Date(e.expires_at),gracePeriodDays:e.grace_period_days||0,lastActivity:new Date(e.updated_at),lastSyncAt:new Date(e.updated_at),notes:e.metadata?.notes||"",createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)}}async getSubscriptions(e,t=1,s=10){let r=new URLSearchParams;r.append("limit",s.toString()),r.append("offset",((t-1)*s).toString()),e&&(e.status&&e.status.length>0&&e.status.forEach(e=>r.append("status",e)),e.tier&&e.tier.length>0&&e.tier.forEach(e=>r.append("tier",e)),e.search&&r.append("search",e.search),e.customerId&&r.append("customer_id",e.customerId),e.startDate&&r.append("start_date",e.startDate.toISOString()),e.endDate&&r.append("end_date",e.endDate.toISOString()));let c=`${this.baseUrl}?${r.toString()}`,i=await a.x.get(c);if(i.success&&i.data){let e=i.data,r=Math.ceil(e.total/s);return{success:!0,data:{data:(e.items||[]).map(e=>this.transformSubscription(e)),totalCount:e.total||0,page:t,pageSize:s,totalPages:r}}}return i}async getSubscription(e){let t=await a.x.get(`${this.baseUrl}/${e}`);return t.success&&t.data?{success:!0,data:this.transformSubscription(t.data)}:t}async createSubscription(e){let t=await a.x.post(this.baseUrl,e);return t.success&&t.data?{success:!0,data:this.transformSubscription(t.data)}:t}async updateSubscription(e,t){try{let s={};void 0!==t.tier&&(s.tier=t.tier),void 0!==t.features&&(Array.isArray(t.features)&&0===t.features.length?s.custom_features={}:Array.isArray(t.features)?s.custom_features=t.features.reduce((e,t)=>(e[t]=!0,e),{}):s.custom_features=t.features),void 0!==t.maxDevices&&(s.max_devices=t.maxDevices),void 0!==t.expiresAt&&(s.expires_at=t.expiresAt),void 0!==t.gracePeriodDays&&(s.grace_period_days=t.gracePeriodDays),void 0!==t.notes&&(s.notes=t.notes);let r=await a.x.put(`${this.baseUrl}/${e}`,s);if(r.success&&r.data)return{success:!0,data:this.transformSubscription(r.data)};return r}catch(e){return console.error("Update subscription error:",e),{success:!1,error:e instanceof Error?e.message:"Update failed"}}}async deleteSubscription(e){return a.x.delete(`${this.baseUrl}/${e}`)}async suspendSubscription(e,t){let s=await a.x.put(`${this.baseUrl}/${e}/suspend`,{reason:t});return s.success&&s.data?{success:!0,data:this.transformSubscription(s.data)}:s}async resumeSubscription(e){let t=await a.x.put(`${this.baseUrl}/${e}/resume`);return t.success&&t.data?{success:!0,data:this.transformSubscription(t.data)}:t}async cancelSubscription(e,t){let s=await a.x.put(`${this.baseUrl}/${e}/cancel`,{reason:t});return s.success&&s.data?{success:!0,data:this.transformSubscription(s.data)}:s}async renewSubscription(e,t){let s=await a.x.post(`${this.baseUrl}/${e}/renew`,{expires_at:t.toISOString()});return s.success&&s.data?{success:!0,data:this.transformSubscription(s.data)}:s}async getSubscriptionAnalytics(e,t){let s=new URLSearchParams;e&&s.append("start_date",e.toISOString()),t&&s.append("end_date",t.toISOString());let r=`${this.baseUrl}/analytics?${s.toString()}`;return a.x.get(r)}async getSubscriptionUsage(e){return a.x.get(`${this.baseUrl}/${e}/usage`)}async getSubscriptionDevices(e){return a.x.get(`${this.baseUrl}/${e}/devices`)}async revokeDeviceAccess(e,t){return a.x.delete(`${this.baseUrl}/${e}/devices/${t}`)}async exportSubscriptions(e){let t=new URLSearchParams;e&&(e.status&&e.status.length>0&&e.status.forEach(e=>t.append("status",e)),e.tier&&e.tier.length>0&&e.tier.forEach(e=>t.append("tier",e)),e.search&&t.append("search",e.search),e.customerId&&t.append("customer_id",e.customerId),e.startDate&&t.append("start_date",e.startDate.toISOString()),e.endDate&&t.append("end_date",e.endDate.toISOString()));let s=`${this.baseUrl}/export?${t.toString()}`,r=`subscriptions_${new Date().toISOString().split("T")[0]}.csv`;await a.x.downloadFile(s,r)}async validateLicenseKey(e){return a.x.post("/api/v1/licensing/validate-key",{license_key:e})}async generateLicenseKey(e){return a.x.post(`${this.baseUrl}/${e}/generate-key`)}async getSubscriptionActivity(e,t=1,s=10){let r=new URLSearchParams;r.append("page",t.toString()),r.append("page_size",s.toString());let c=`${this.baseUrl}/${e}/activity?${r.toString()}`;return a.x.get(c)}async bulkUpdateSubscriptions(e,t){return a.x.post(`${this.baseUrl}/bulk-update`,{subscription_ids:e,updates:t})}async getHealthCheck(){return a.x.get("/api/v1/health")}constructor(){this.baseUrl="/api/v1/subscription/subscriptions"}}new c;let i=e=>{let t=(0,r.useRef)(new c).current,[s,a]=(0,r.useState)({subscriptions:[],selectedSubscription:null,totalCount:0,currentPage:1,pageSize:10,filters:e||{},isLoading:!1,isFetching:!1,isCreating:!1,isUpdating:!1,isDeleting:!1,error:null,hasMore:!1}),i=(0,r.useCallback)(async(e=1,r=!1)=>{let c=1===e?"isLoading":"isFetching";a(e=>({...e,[c]:!0,error:null,...r&&{subscriptions:[],currentPage:1}}));try{let i=await t.getSubscriptions(s.filters,e,s.pageSize);if(i.success&&i.data){let t=i.data,n=1===e||r?t.data:[...s.subscriptions,...t.data],o=e<t.totalPages;a(s=>({...s,subscriptions:n,totalCount:t.totalCount,currentPage:e,hasMore:o,[c]:!1,error:null}))}else a(e=>({...e,[c]:!1,error:i.error||"Failed to fetch subscriptions"}))}catch(e){a(t=>({...t,[c]:!1,error:e instanceof Error?e.message:"Failed to fetch subscriptions"}))}},[t,s.filters,s.pageSize,s.subscriptions]),n=(0,r.useCallback)(async()=>{s.hasMore&&!s.isFetching&&await i(s.currentPage+1)},[i,s.hasMore,s.isFetching,s.currentPage]),o=(0,r.useCallback)(async()=>{await i(1,!0)},[i]),u=(0,r.useCallback)(async e=>{try{let s=await t.getSubscription(e);if(s.success&&s.data)return{success:!0,data:s.data};return{success:!1,error:s.error||"Failed to fetch subscription"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch subscription"}}},[t]),d=(0,r.useCallback)(async e=>{a(e=>({...e,isCreating:!0,error:null}));try{let s=await t.createSubscription(e);if(s.success&&s.data)return a(e=>({...e,subscriptions:[s.data,...e.subscriptions],totalCount:e.totalCount+1,isCreating:!1,error:null})),{success:!0,data:s.data};return a(e=>({...e,isCreating:!1,error:s.error||"Failed to create subscription"})),{success:!1,error:s.error||"Failed to create subscription"}}catch(t){let e=t instanceof Error?t.message:"Failed to create subscription";return a(t=>({...t,isCreating:!1,error:e})),{success:!1,error:e}}},[t]),l=(0,r.useCallback)(async(e,s)=>{a(e=>({...e,isUpdating:!0,error:null}));try{let r=await t.updateSubscription(e,s);if(r.success&&r.data)return a(t=>({...t,subscriptions:t.subscriptions.map(t=>t.id===e?r.data:t),selectedSubscription:t.selectedSubscription?.id===e?r.data:t.selectedSubscription,isUpdating:!1,error:null})),{success:!0,data:r.data};return a(e=>({...e,isUpdating:!1,error:r.error||"Failed to update subscription"})),{success:!1,error:r.error||"Failed to update subscription"}}catch(t){let e=t instanceof Error?t.message:"Failed to update subscription";return a(t=>({...t,isUpdating:!1,error:e})),{success:!1,error:e}}},[t]),p=(0,r.useCallback)(async e=>{a(e=>({...e,isDeleting:!0,error:null}));try{let s=await t.deleteSubscription(e);if(s.success)return a(t=>({...t,subscriptions:t.subscriptions.filter(t=>t.id!==e),selectedSubscription:t.selectedSubscription?.id===e?null:t.selectedSubscription,totalCount:t.totalCount-1,isDeleting:!1,error:null})),{success:!0};return a(e=>({...e,isDeleting:!1,error:s.error||"Failed to delete subscription"})),{success:!1,error:s.error||"Failed to delete subscription"}}catch(t){let e=t instanceof Error?t.message:"Failed to delete subscription";return a(t=>({...t,isDeleting:!1,error:e})),{success:!1,error:e}}},[t]),b=(0,r.useCallback)(async(e,s)=>{try{let r=await t.suspendSubscription(e,s);if(r.success&&r.data)return a(t=>({...t,subscriptions:t.subscriptions.map(t=>t.id===e?r.data:t),selectedSubscription:t.selectedSubscription?.id===e?r.data:t.selectedSubscription})),{success:!0,data:r.data};return{success:!1,error:r.error||"Failed to suspend subscription"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to suspend subscription"}}},[t]),h=(0,r.useCallback)(async e=>{try{let s=await t.resumeSubscription(e);if(s.success&&s.data)return a(t=>({...t,subscriptions:t.subscriptions.map(t=>t.id===e?s.data:t),selectedSubscription:t.selectedSubscription?.id===e?s.data:t.selectedSubscription})),{success:!0,data:s.data};return{success:!1,error:s.error||"Failed to resume subscription"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to resume subscription"}}},[t]),g=(0,r.useCallback)(async(e,s)=>{try{let r=await t.cancelSubscription(e,s);if(r.success&&r.data)return a(t=>({...t,subscriptions:t.subscriptions.map(t=>t.id===e?r.data:t),selectedSubscription:t.selectedSubscription?.id===e?r.data:t.selectedSubscription})),{success:!0,data:r.data};return{success:!1,error:r.error||"Failed to cancel subscription"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to cancel subscription"}}},[t]),S=(0,r.useCallback)(async(e,s)=>{try{let r=await t.renewSubscription(e,s);if(r.success&&r.data)return a(t=>({...t,subscriptions:t.subscriptions.map(t=>t.id===e?r.data:t),selectedSubscription:t.selectedSubscription?.id===e?r.data:t.selectedSubscription})),{success:!0,data:r.data};return{success:!1,error:r.error||"Failed to renew subscription"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to renew subscription"}}},[t]),m=(0,r.useCallback)(async e=>{try{let s=await t.getSubscriptionDevices(e);if(s.success&&s.data)return{success:!0,data:s.data};return{success:!1,error:s.error||"Failed to fetch devices"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to fetch devices"}}},[t]),y=(0,r.useCallback)(async(e,s)=>{try{let r=await t.revokeDeviceAccess(e,s);if(r.success)return{success:!0};return{success:!1,error:r.error||"Failed to revoke device access"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to revoke device access"}}},[t]),f=(0,r.useCallback)(async e=>{try{let s=await t.validateLicenseKey(e);if(s.success&&s.data)return{success:!0,data:s.data};return{success:!1,error:s.error||"Failed to validate license key"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to validate license key"}}},[t]),E=(0,r.useCallback)(async e=>{try{let s=await t.generateLicenseKey(e);if(s.success&&s.data)return{success:!0,data:s.data};return{success:!1,error:s.error||"Failed to generate license key"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to generate license key"}}},[t]),w=(0,r.useCallback)(async(e,s)=>{try{let r=await t.bulkUpdateSubscriptions(e,s);if(r.success&&r.data)return await o(),{success:!0,data:r.data};return{success:!1,error:r.error||"Failed to bulk update subscriptions"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to bulk update subscriptions"}}},[t,o]),C=(0,r.useCallback)(e=>{a(t=>({...t,filters:{...t.filters,...e},currentPage:1}))},[]),D=(0,r.useCallback)(()=>{a(e=>({...e,filters:{},currentPage:1}))},[]),v=(0,r.useCallback)(e=>{a(t=>({...t,selectedSubscription:e}))},[]),A=(0,r.useCallback)(async()=>{try{return await t.exportSubscriptions(s.filters),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to export subscriptions"}}},[t,s.filters]),U=(0,r.useCallback)(()=>{a(e=>({...e,error:null}))},[]);return(0,r.useEffect)(()=>{i(1,!0)},[s.filters]),{...s,fetchSubscriptions:i,loadMore:n,refetch:o,getSubscription:u,createSubscription:d,updateSubscription:l,deleteSubscription:p,suspendSubscription:b,resumeSubscription:h,cancelSubscription:g,renewSubscription:S,getSubscriptionDevices:m,revokeDeviceAccess:y,validateLicenseKey:f,generateLicenseKey:E,bulkUpdateSubscriptions:w,setFilters:C,clearFilters:D,setSelectedSubscription:v,exportSubscriptions:A,clearError:U}}},51471:(e,t,s)=>{s.d(t,{x:()=>c});let r=s(44099).Z.create({baseURL:"http://localhost:8000",timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}});r.interceptors.request.use(e=>{let t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),window.location.href="/login"),e.response?.status===403&&console.error("Permission denied"),e.response?.status>=500&&console.error("Server error:",e.response?.data?.message||e.message),Promise.reject(e)));class a{constructor(){this.instance=r}async get(e,t){try{let s=await this.instance.get(e,t);return{success:!0,data:s.data}}catch(e){return this.handleError(e)}}async post(e,t,s){try{let r=await this.instance.post(e,t,s);return{success:!0,data:r.data}}catch(e){return this.handleError(e)}}async put(e,t,s){try{let r=await this.instance.put(e,t,s);return{success:!0,data:r.data}}catch(e){return this.handleError(e)}}async patch(e,t,s){try{let r=await this.instance.patch(e,t,s);return{success:!0,data:r.data}}catch(e){return this.handleError(e)}}async delete(e,t){try{let s=await this.instance.delete(e,t);return{success:!0,data:s.data}}catch(e){return this.handleError(e)}}handleError(e){return e.response?{success:!1,error:e.response.data?.message||e.response.statusText}:e.request?{success:!1,error:"Network error - please check your internet connection"}:{success:!1,error:e.message||"An unexpected error occurred"}}async uploadFile(e,t,s){let r=new FormData;r.append("file",t);try{let t=await this.instance.post(e,r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{if(s&&e.total){let t=Math.round(100*e.loaded/e.total);s(t)}}});return{success:!0,data:t.data}}catch(e){return this.handleError(e)}}async downloadFile(e,t){try{let s=await this.instance.get(e,{responseType:"blob"}),r=new Blob([s.data]),a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=t,a.click(),window.URL.revokeObjectURL(a.href)}catch(e){throw console.error("File download failed:",e),e}}setAuthToken(e){this.instance.defaults.headers.Authorization=`Bearer ${e}`}clearAuthToken(){delete this.instance.defaults.headers.Authorization}}let c=new a},35342:(e,t,s)=>{var r,a,c,i,n,o,u,d,l,p;s.d(t,{QV:()=>a,XL:()=>o,uG:()=>u}),function(e){e.ACTIVE="active",e.EXPIRED="expired",e.CANCELLED="cancelled",e.SUSPENDED="suspended",e.PENDING="pending"}(r||(r={})),function(e){e.BASIC="basic",e.PROFESSIONAL="professional",e.ENTERPRISE="enterprise"}(a||(a={})),function(e){e.ACTIVE="active",e.INACTIVE="inactive",e.SUSPENDED="suspended",e.DELETED="deleted"}(c||(c={})),function(e){e.ACTIVE="active",e.INACTIVE="inactive",e.SUSPENDED="suspended",e.REVOKED="revoked"}(i||(i={})),function(e){e.PENDING="pending",e.PROCESSING="processing",e.COMPLETED="completed",e.FAILED="failed",e.CANCELLED="cancelled",e.REFUNDED="refunded",e.PARTIALLY_REFUNDED="partially_refunded",e.EXPIRED="expired"}(n||(n={})),function(e){e.MANUAL="manual",e.BANK_TRANSFER="bank_transfer",e.CREDIT_CARD="credit_card",e.DEBIT_CARD="debit_card",e.PAYPAL="paypal",e.STRIPE="stripe",e.CASH="cash",e.CHECK="check",e.WIRE_TRANSFER="wire_transfer",e.CRYPTOCURRENCY="cryptocurrency",e.OTHER="other"}(o||(o={})),function(e){e.SUBSCRIPTION="subscription",e.RENEWAL="renewal",e.UPGRADE="upgrade",e.REFUND="refund"}(u||(u={})),function(e){e.ADMIN="admin",e.MANAGER="manager",e.SUPPORT="support",e.VIEWER="viewer"}(d||(d={})),function(e){e.SYSTEM="system",e.SECURITY="security",e.SUBSCRIPTION="subscription",e.DEVICE="device",e.BILLING="billing"}(l||(l={})),function(e){e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical"}(p||(p={}))}};