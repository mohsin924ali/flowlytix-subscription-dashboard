(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{49423:function(e,s,r){Promise.resolve().then(r.bind(r,16117))},16117:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return U}});var t=r(57437),i=r(2265),n=r(1899),a=r(5002),l=r(94013),o=r(15735),c=r(67208),d=r(36137),x=r(35389),h=r(67571),u=r(89414),g=r(22095),f=r(96207),j=r(70208),Z=r(32281),p=r(54301),m=r(61201),b=r(59469),v=r(67116),y=r(59253),S=r(59832),w=r(60407),I=r(29886),k=r(29821),z=r(9815),C=r(621),L=r(29946),P=r(70412),W=r(82406),A=r(92798),_=r(79335),R=r(23478),E=r(29541),D=r(5837),N=r(25188),F=r(84323),O=r(91363),J=r(27648),B=r(30482),H=r(94599),T=r(98734);let K=e=>{switch(e){case"active":return"success";case"inactive":return"error";case"suspended":return"warning";default:return"default"}},M=e=>{switch(e){case"premium":return"#FF6B35";case"pro":return"#4ECDC4";case"basic":return"#45B7D1";default:return"#95A5A6"}};function U(){var e;let{subscriptions:s,totalCount:r,isLoading:U,error:Q,fetchSubscriptions:$}=(0,H.P)(),{dashboardData:q,systemHealth:G,isLoadingDashboard:V,error:X,fetchSystemHealth:Y}=(0,B.z)();(0,T.a)();let[ee,es]=(0,i.useState)("checking"),[er,et]=(0,i.useState)(0),[ei,en]=(0,i.useState)(10),ea=Array.isArray(s)?s:[];(0,i.useEffect)(()=>{(async()=>{try{(await fetch("http://localhost:8000/health")).ok?es("healthy"):es("error")}catch(e){es("error")}})()},[]),(0,i.useEffect)(()=>{$(),Y()},[]);let el=ea.filter(e=>"active"===e.status).length;ea.filter(e=>"expired"===e.status).length;let eo=ea.slice(er*ei,er*ei+ei);return(0,t.jsxs)(n.Z,{sx:{px:2,py:1},children:[(0,t.jsxs)(n.Z,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)(n.Z,{children:[(0,t.jsx)(a.Z,{variant:"h4",component:"h1",sx:{fontWeight:700,color:"#1e293b"},children:"Dashboard"}),(0,t.jsx)(a.Z,{variant:"body1",color:"textSecondary",children:"Welcome to your subscription management dashboard"})]}),(0,t.jsx)(J.default,{href:"/subscriptions/create",style:{textDecoration:"none"},children:(0,t.jsx)(l.Z,{variant:"contained",startIcon:(0,t.jsx)(I.Z,{}),size:"large",sx:{borderRadius:2},children:"New Subscription"})})]}),Q&&(0,t.jsxs)(o.Z,{severity:"error",sx:{mb:3},children:[(0,t.jsx)("strong",{children:"Subscriptions Error:"})," ",Q]}),X&&(0,t.jsxs)(o.Z,{severity:"error",sx:{mb:3},children:[(0,t.jsx)("strong",{children:"Analytics Error:"})," ",X]}),(0,t.jsx)(c.Z,{sx:{mb:3,bgcolor:"healthy"===ee?"#f0f9ff":"#fef2f2"},children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:["checking"===ee&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{size:24}),(0,t.jsx)(a.Z,{children:"Checking server connection..."})]}),"healthy"===ee&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Z,{sx:{color:"#10b981"}}),(0,t.jsx)(a.Z,{sx:{color:"#065f46",fontWeight:600},children:"Server Status: Healthy & Running"}),(0,t.jsx)(h.Z,{label:"Live",size:"small",sx:{bgcolor:"#10b981",color:"white"}})]}),"error"===ee&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z.Z,{sx:{color:"#ef4444"}}),(0,t.jsx)(a.Z,{sx:{color:"#dc2626",fontWeight:600},children:"Server Connection Failed"}),(0,t.jsx)(h.Z,{label:"Offline",size:"small",sx:{bgcolor:"#ef4444",color:"white"}})]})]})})}),(0,t.jsxs)(u.ZP,{container:!0,spacing:3,sx:{mb:4},children:[(0,t.jsx)(u.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)(c.Z,{sx:{height:"100%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",position:"relative",overflow:"hidden"},children:[(0,t.jsx)(n.Z,{sx:{position:"absolute",top:-50,right:-50,opacity:.1,fontSize:120},children:(0,t.jsx)(C.Z,{})}),(0,t.jsxs)(d.Z,{children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[(0,t.jsx)(C.Z,{sx:{fontSize:40}}),(0,t.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600},children:"Total Subscribers"})]}),(0,t.jsx)(a.Z,{variant:"h3",sx:{fontWeight:700,mb:1},children:U?(0,t.jsx)(x.Z,{size:24,color:"inherit"}):(null==r?void 0:r.toLocaleString())||"0"}),(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(L.Z,{sx:{fontSize:16}}),(0,t.jsx)(a.Z,{variant:"body2",children:"+12% from last month"})]})]})]})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)(c.Z,{sx:{height:"100%",background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"white",position:"relative",overflow:"hidden"},children:[(0,t.jsx)(n.Z,{sx:{position:"absolute",top:-50,right:-50,opacity:.1,fontSize:120},children:(0,t.jsx)(k.Z,{})}),(0,t.jsxs)(d.Z,{children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[(0,t.jsx)(k.Z,{sx:{fontSize:40}}),(0,t.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600},children:"Active Subscriptions"})]}),(0,t.jsx)(a.Z,{variant:"h3",sx:{fontWeight:700,mb:1},children:U?(0,t.jsx)(x.Z,{size:24,color:"inherit"}):el.toLocaleString()}),(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(L.Z,{sx:{fontSize:16}}),(0,t.jsxs)(a.Z,{variant:"body2",children:[r>0?"".concat((el/r*100).toFixed(1),"%"):"0%"," active rate"]})]})]})]})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)(c.Z,{sx:{height:"100%",background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",color:"white",position:"relative",overflow:"hidden"},children:[(0,t.jsx)(n.Z,{sx:{position:"absolute",top:-50,right:-50,opacity:.1,fontSize:120},children:(0,t.jsx)(P.Z,{})}),(0,t.jsxs)(d.Z,{children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[(0,t.jsx)(P.Z,{sx:{fontSize:40}}),(0,t.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600},children:"Monthly Revenue"})]}),(0,t.jsxs)(a.Z,{variant:"h3",sx:{fontWeight:700,mb:1},children:["$",(null==q?void 0:null===(e=q.monthlyRevenue)||void 0===e?void 0:e.toLocaleString())||"0"]}),(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(L.Z,{sx:{fontSize:16}}),(0,t.jsx)(a.Z,{variant:"body2",children:"+8% from last month"})]})]})]})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)(c.Z,{sx:{height:"100%",background:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",color:"white",position:"relative",overflow:"hidden"},children:[(0,t.jsx)(n.Z,{sx:{position:"absolute",top:-50,right:-50,opacity:.1,fontSize:120},children:(0,t.jsx)(W.Z,{})}),(0,t.jsxs)(d.Z,{children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[(0,t.jsx)(W.Z,{sx:{fontSize:40}}),(0,t.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600},children:"System Performance"})]}),(0,t.jsx)(a.Z,{variant:"h3",sx:{fontWeight:700,mb:1},children:(null==G?void 0:G.uptime)||"99.9%"}),(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(L.Z,{sx:{fontSize:16}}),(0,t.jsx)(a.Z,{variant:"body2",children:"Excellent uptime"})]})]})]})})]}),(0,t.jsx)(c.Z,{sx:{mb:4},children:(0,t.jsxs)(d.Z,{children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,t.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600,color:"#1e293b"},children:"Subscribers"}),(0,t.jsxs)(n.Z,{sx:{display:"flex",gap:1},children:[(0,t.jsx)(l.Z,{variant:"outlined",size:"small",startIcon:(0,t.jsx)(A.Z,{}),sx:{borderRadius:2},children:"Filter"}),(0,t.jsx)(l.Z,{variant:"outlined",size:"small",startIcon:(0,t.jsx)(_.Z,{}),sx:{borderRadius:2},children:"Search"}),(0,t.jsx)(l.Z,{variant:"contained",size:"small",startIcon:(0,t.jsx)(R.Z,{}),onClick:()=>$(),sx:{borderRadius:2},children:"Refresh"})]})]}),(0,t.jsx)(g.Z,{component:f.Z,sx:{borderRadius:2,boxShadow:"none",border:"1px solid #e2e8f0"},children:(0,t.jsxs)(j.Z,{children:[(0,t.jsx)(Z.Z,{children:(0,t.jsxs)(p.Z,{sx:{bgcolor:"#f8fafc"},children:[(0,t.jsx)(m.Z,{sx:{fontWeight:600,color:"#475569"},children:"Customer"}),(0,t.jsx)(m.Z,{sx:{fontWeight:600,color:"#475569"},children:"License Key"}),(0,t.jsx)(m.Z,{sx:{fontWeight:600,color:"#475569"},children:"Plan"}),(0,t.jsx)(m.Z,{sx:{fontWeight:600,color:"#475569"},children:"Status"}),(0,t.jsx)(m.Z,{sx:{fontWeight:600,color:"#475569"},children:"Devices"}),(0,t.jsx)(m.Z,{sx:{fontWeight:600,color:"#475569"},children:"Expires"}),(0,t.jsx)(m.Z,{sx:{fontWeight:600,color:"#475569"},children:"Actions"})]})}),(0,t.jsx)(b.Z,{children:U?(0,t.jsx)(p.Z,{children:(0,t.jsx)(m.Z,{colSpan:7,sx:{textAlign:"center",py:4},children:(0,t.jsx)(x.Z,{})})}):0===eo.length?(0,t.jsx)(p.Z,{children:(0,t.jsx)(m.Z,{colSpan:7,sx:{textAlign:"center",py:4},children:(0,t.jsx)(a.Z,{variant:"body2",color:"text.secondary",children:"No subscribers found"})})}):eo.map(e=>(0,t.jsxs)(p.Z,{hover:!0,children:[(0,t.jsx)(m.Z,{children:(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,t.jsx)(v.Z,{sx:{bgcolor:M(e.tier),width:40,height:40},children:e.customerName.charAt(0)}),(0,t.jsxs)(n.Z,{children:[(0,t.jsx)(a.Z,{variant:"body2",sx:{fontWeight:600},children:e.customerName}),(0,t.jsxs)(a.Z,{variant:"caption",color:"text.secondary",children:["ID: ",e.customerId]})]})]})}),(0,t.jsx)(m.Z,{children:(0,t.jsx)(a.Z,{variant:"body2",sx:{fontFamily:"monospace"},children:e.licenseKey})}),(0,t.jsx)(m.Z,{children:(0,t.jsx)(h.Z,{label:e.tier.toUpperCase(),size:"small",sx:{bgcolor:M(e.tier),color:"white",fontWeight:600}})}),(0,t.jsx)(m.Z,{children:(0,t.jsx)(h.Z,{label:e.status.toUpperCase(),size:"small",color:K(e.status),variant:"filled"})}),(0,t.jsx)(m.Z,{children:(0,t.jsxs)(n.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(E.Z,{sx:{fontSize:16,color:"#64748b"}}),(0,t.jsxs)(a.Z,{variant:"body2",children:[e.devicesConnected,"/",e.maxDevices]}),(0,t.jsx)(y.Z,{variant:"determinate",value:e.devicesConnected/e.maxDevices*100,sx:{width:40,height:6,borderRadius:3,bgcolor:"#e2e8f0","& .MuiLinearProgress-bar":{bgcolor:e.devicesConnected===e.maxDevices?"#ef4444":"#10b981"}}})]})}),(0,t.jsx)(m.Z,{children:(0,t.jsx)(a.Z,{variant:"body2",color:"text.secondary",children:new Date(e.expiresAt).toLocaleDateString()})}),(0,t.jsx)(m.Z,{children:(0,t.jsx)(S.Z,{size:"small",children:(0,t.jsx)(D.Z,{})})})]},e.id))})]})}),(0,t.jsx)(w.Z,{rowsPerPageOptions:[5,10,25,50],component:"div",count:ea.length,rowsPerPage:ei,page:er,onPageChange:(e,s)=>{et(s)},onRowsPerPageChange:e=>{en(parseInt(e.target.value,10)),et(0)}})]})}),(0,t.jsxs)(u.ZP,{container:!0,spacing:3,children:[(0,t.jsx)(u.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(c.Z,{children:(0,t.jsxs)(d.Z,{children:[(0,t.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Quick Actions"}),(0,t.jsxs)(n.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,t.jsx)(l.Z,{variant:"outlined",startIcon:(0,t.jsx)(N.Z,{}),href:"http://localhost:8000/docs",target:"_blank",sx:{borderRadius:2},children:"API Documentation"}),(0,t.jsx)(l.Z,{variant:"outlined",startIcon:(0,t.jsx)(F.Z,{}),href:"http://localhost:8000/health",target:"_blank",sx:{borderRadius:2},children:"Health Check"}),(0,t.jsx)(l.Z,{variant:"outlined",startIcon:(0,t.jsx)(O.Z,{}),onClick:()=>window.location.reload(),sx:{borderRadius:2},children:"Refresh Data"})]})]})})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(c.Z,{children:(0,t.jsxs)(d.Z,{children:[(0,t.jsx)(a.Z,{variant:"h6",sx:{fontWeight:600,mb:2},children:"System Status"}),(0,t.jsxs)(n.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,t.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(a.Z,{variant:"body2",children:"Frontend (Next.js)"}),(0,t.jsx)(h.Z,{label:"Running",color:"success",size:"small"})]}),(0,t.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(a.Z,{variant:"body2",children:"Backend (FastAPI)"}),(0,t.jsx)(h.Z,{label:"healthy"===ee?"Healthy":"Error",color:"healthy"===ee?"success":"error",size:"small"})]}),(0,t.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(a.Z,{variant:"body2",children:"Database"}),(0,t.jsx)(h.Z,{label:"Connected",color:"success",size:"small"})]})]})]})})})]})]})}},98734:function(e,s,r){"use strict";r.d(s,{a:function(){return n}});var t=r(2265),i=r(28223);let n=()=>{let[e,s]=(0,t.useState)({user:null,token:null,isAuthenticated:!1,isLoading:!1,isInitializing:!0,error:null}),r=(0,t.useCallback)(async()=>{try{let e=localStorage.getItem("auth_token"),r=localStorage.getItem("auth_user");if(e&&r){let t=JSON.parse(r);s(s=>({...s,user:t,token:e,isAuthenticated:!0,isInitializing:!1}))}else s(e=>({...e,isInitializing:!1}))}catch(e){localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),s(e=>({...e,isInitializing:!1,error:"Authentication verification failed"}))}},[]),n=(0,t.useCallback)(async e=>{s(e=>({...e,isLoading:!0,error:null}));try{let r=await i.x.post("/api/v1/auth/login",e);if(!r.success||!r.data)return s(e=>({...e,isLoading:!1,error:r.error||"Login failed"})),{success:!1,error:r.error||"Login failed"};{let{user:e,token:t}=r.data;return localStorage.setItem("auth_token",t),localStorage.setItem("auth_user",JSON.stringify(e)),s(s=>({...s,user:e,token:t,isAuthenticated:!0,isLoading:!1,error:null})),{success:!0}}}catch(r){let e=r instanceof Error?r.message:"Login failed";return s(s=>({...s,isLoading:!1,error:e})),{success:!1,error:e}}},[]),a=(0,t.useCallback)(async e=>{s(e=>({...e,isLoading:!0,error:null}));try{let r=await i.x.post("/api/v1/auth/register",e);if(!r.success||!r.data)return s(e=>({...e,isLoading:!1,error:r.error||"Registration failed"})),{success:!1,error:r.error||"Registration failed"};{let{user:e,token:t}=r.data;return localStorage.setItem("auth_token",t),localStorage.setItem("auth_user",JSON.stringify(e)),s(s=>({...s,user:e,token:t,isAuthenticated:!0,isLoading:!1,error:null})),{success:!0}}}catch(r){let e=r instanceof Error?r.message:"Registration failed";return s(s=>({...s,isLoading:!1,error:e})),{success:!1,error:e}}},[]),l=(0,t.useCallback)(async()=>{s(e=>({...e,isLoading:!0}));try{await i.x.post("/api/v1/auth/logout")}catch(e){console.warn("Logout API call failed:",e)}finally{localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),s({user:null,token:null,isAuthenticated:!1,isLoading:!1,isInitializing:!1,error:null})}},[]),o=(0,t.useCallback)(async()=>{try{let e=await i.x.post("/api/v1/auth/refresh");if(!e.success||!e.data)return{success:!1,error:e.error||"Token refresh failed"};{let{token:r}=e.data;return localStorage.setItem("auth_token",r),s(e=>({...e,token:r,error:null})),{success:!0}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Token refresh failed"}}},[]),c=(0,t.useCallback)(()=>{s(e=>({...e,error:null}))},[]),d=(0,t.useCallback)(async e=>{s(e=>({...e,isLoading:!0,error:null}));try{let r=await i.x.patch("/api/v1/auth/profile",e);if(!r.success||!r.data)return s(e=>({...e,isLoading:!1,error:r.error||"Profile update failed"})),{success:!1,error:r.error||"Profile update failed"};{let e=r.data;return localStorage.setItem("auth_user",JSON.stringify(e)),s(s=>({...s,user:e,isLoading:!1,error:null})),{success:!0}}}catch(r){let e=r instanceof Error?r.message:"Profile update failed";return s(s=>({...s,isLoading:!1,error:e})),{success:!1,error:e}}},[]),x=(0,t.useCallback)(async(e,r)=>{s(e=>({...e,isLoading:!0,error:null}));try{let t=await i.x.post("/api/v1/auth/change-password",{currentPassword:e,newPassword:r});if(t.success)return s(e=>({...e,isLoading:!1,error:null})),{success:!0};return s(e=>({...e,isLoading:!1,error:t.error||"Password change failed"})),{success:!1,error:t.error||"Password change failed"}}catch(r){let e=r instanceof Error?r.message:"Password change failed";return s(s=>({...s,isLoading:!1,error:e})),{success:!1,error:e}}},[]),h=(0,t.useCallback)(async e=>{s(e=>({...e,isLoading:!0,error:null}));try{let r=await i.x.post("/api/v1/auth/reset-password",{email:e});if(r.success)return s(e=>({...e,isLoading:!1,error:null})),{success:!0};return s(e=>({...e,isLoading:!1,error:r.error||"Password reset failed"})),{success:!1,error:r.error||"Password reset failed"}}catch(r){let e=r instanceof Error?r.message:"Password reset failed";return s(s=>({...s,isLoading:!1,error:e})),{success:!1,error:e}}},[]),u=(0,t.useCallback)(s=>{var r,t;return(null===(t=e.user)||void 0===t?void 0:null===(r=t.permissions)||void 0===r?void 0:r.includes(s))||!1},[e.user]),g=(0,t.useCallback)(s=>{var r;return(null===(r=e.user)||void 0===r?void 0:r.role)===s},[e.user]);return(0,t.useEffect)(()=>{r()},[r]),{...e,login:n,register:a,logout:l,refreshToken:o,clearError:c,updateProfile:d,changePassword:x,resetPassword:h,checkPermission:u,hasRole:g}}}},function(e){e.O(0,[355,152,160,735,593,414,617,841,489,886,482,971,117,744],function(){return e(e.s=49423)}),_N_E=e.O()}]);